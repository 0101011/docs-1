tasks:
  - name: "install"
    commands: shell.exec
    params:
      script: |
        # sudo apt-get -y install fonts-inconsolata  imagemagick inkscape
        # sudo apt-get -y install texlive-latex-base texlive-latex-extra texlive-fonts-recommended

        virutalenv ~/venv-docs
        source ~/venv-giza/bin/activate

        sudo pip install -r requirements.txt
  - name: "generate_source"
    commands: shell.exec
    params:
      script: |
        source ~/venv-giza/bin/activate

        giza generate source
  - name: "build_sphinx"
    commands: shell.exec
    params:
      script: |
        source ~/venv-giza/bin/activate

        giza generate sphinx --builder publish
  - name: "package"
    commands: shell.exec
    params:
      script: |
        source ~/venv-giza/bin/activate

        giza env package --builder publish
        giza packaging create --target push

  # TODO: deploy build/archive/* to s3

buildvariants:
  - name: ubuntu1404-release
    display_name: "Ubuntu 14.04"
    run_on:
      - ubuntu1404-test
    tasks:
      - name: "install"
      - name: "generate_source"
      - name: "build_sphinx"
      - name: "package"
