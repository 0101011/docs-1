:orphan:

=================================================
Development Reference for 3.2.0 Release Candidate
=================================================

.. default-domain:: mongodb

MongoDB 3.2 is currently in development.

.. warning::

   While 3.2 release candidates are available, these versions of
   MONGODB are for **testing purposes only and not for production use**.

See also :doc:`/release-notes/3.2`.

Aggregation Framework Enhancements
----------------------------------

New Stages
~~~~~~~~~~

MongoDB 3.2 introduces the following new stages for the
aggregation framework:


New Accumulators for ``$group`` Stage
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

MongoDB 3.2 introduces the following new accumulators for the
aggregation framework:

.. group:: $stdDevSamp

   Calculates the sample standard deviation of the input values. Use if
   the values encompasses a sample of a population of data from which
   to generalize about the population. Use :group:`$stdDevPop` if the
   values represent the entire population of data or you do not wish to
   generalize about a larger population.

.. group:: $stdDevPop

   Calculates the population standard deviation of the input values.
   Use if the values encompasses the entire population of data you want
   to represent and do not wish to generalize about a larger
   population. Use :group:`$stdDevSamp` if the values represent only a
   sample of a population of data from which to generalize about the
   population.

New Arithmetic Expression Operators
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. TODO When moving to separate pages, use an extract file to single-source null/NaN argument behavior.

New Array Expression Operators
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

MongoDB 3.2 introduces the following new array operators for the
aggregation framework:

.. expression:: $arrayElemAt

   Returns the element at the specified array index.

   :expression:`$arrayElemAt` has the following syntax:

   .. code-block:: javascript

      { $arrayElemAt: [ <array>, <idx> ] }

   The ``<array>`` expression can be any valid :ref:`expression
   <aggregation-expressions>` as long as it resolves to an array.

   The ``<idx>`` expression can be any valid :ref:`expression
   <aggregation-expressions>` as long as it resolves to an integer.

   - If positive, :expression:`$arrayElemAt` returns the element at the
     ``idx`` position, counting from the start of the array.

   - If negative, :expression:`$arrayElemAt` returns the element at the
     ``idx`` position, counting from the end of the array.

   For more information on expressions, see
   :ref:`aggregation-expressions`.

   .. list-table::
      :header-rows: 1
      :widths: 90 10

      * - Example
        - Results

      * - ``{ $arrayElemAt: [ [ 1, 2, 3 ], 0 ] }``
        - ``1``

      * - ``{ $arrayElemAt: [ [ 1, 2, 3 ], -2 ] }``
        - ``2``

      * - ``{ $arrayElemAt: [ [ 1, 2, 3 ], 15 ] }``
        - 

   If the ``idx`` exceeds the array bounds, :expression:`$arrayElemAt`
   does not return any result.

.. expression:: $concatArrays

   Concatenates arrays to return the concatenated array.

   :expression:`$concatArrays` has the following syntax:

   .. code-block:: javascript

      { $concatArrays: [ <array1>, <array2>, ... ] }

   The ``<array>`` expressions can be any valid :ref:`expression
   <aggregation-expressions>` as long as they resolve to an array. For
   more information on expressions, see :ref:`aggregation-expressions`.

   .. list-table::
      :header-rows: 1
      :widths: 65 35

      * - Example
        - Results

      * - ``{ $concatArrays: [ [ "hello", " "], [ "world" ] ] }``
        - ``[ "hello", " ", "world" ]``

      * - ``{ $concatArrays: [ [ "hello", " "], [ [ "world" ], "again"] ] }``
        - ``[ "hello", " ", [ "world" ], "again" ]``

.. expression:: $isArray

   Determines if the operand is an array. Returns a boolean.

   :expression:`$isArray` has the following syntax:

   .. code-block:: javascript

      { $isArray: [ <expression> ] }

   The ``<expression>`` can be any valid :ref:`expression
   <aggregation-expressions>`. For more information on expressions, see
   :ref:`aggregation-expressions`.

   .. list-table::
      :header-rows: 1
      :widths: 90 10

      * - Example
        - Results

      * - ``{ $isArray: [ "hello" ] }``
        - ``false``

      * - ``{ $isArray: [ [ "hello", "world" ] ] }``
        - ``true``

.. expression:: $filter

   Selects a subset of the array to return based on the specified
   condition. Returns an array with only those elements that match the
   condition. The returned elements are in the original order.

   :expression:`$filter` has the following syntax:

   .. code-block:: javascript

      { $filter: { input: <array>, as: <string>, cond: <expression> } }

   .. list-table::
      :header-rows: 1
      :widths: 20 80

      * - Field
        - Specification

      * - ``input``

        - An :ref:`expression <aggregation-expressions>` that
          resolves to an array.

      * - ``as``

        - The variable name for the element in the ``input`` array. The
          ``as`` expression accesses each element in the ``input``
          array by this :doc:`variable
          </reference/aggregation-variables>`.

      * - ``cond``

        - The :ref:`expression <aggregation-expressions>` that
          determines whether to include the element in the resulting
          array. The expression accesses the element by the variable
          name specified in ``as``.

   For more information on expressions, see
   :ref:`aggregation-expressions`.

   .. list-table::
      :header-rows: 1

      * - Example
        - Results

      * - .. code-block:: javascript

             {
               $filter: {
                  input: [ 1, "a", 2, null, 3.1, NumberLong(4), "5" ],
                  as: "num",
                  cond: { $and: [
                     { $gte: [ "$$num", NumberLong("-9223372036854775807") ] }, 
                     { $lte: [ "$$num", NumberLong("9223372036854775807") ] }
                   ] } 
               }
             }

        - ``[ 1, 2, 3.1, NumberLong(4) ]``

``mongo`` Shell Enhancements
----------------------------

To provide consistency with the MongoDB drivers' CRUD
(Create/Read/Update/Delete) API, the :program:`mongo` shell introduces
additional CRUD methods that are consistent with the drivers' CRUD API:

.. _db.collection.deleteMany:

.. method:: db.collection.deleteMany()

   Deletes all documents that match the ``filter`` condition. The
   method is equivalent to :method:`db.collection.remove()`.

   :method:`db.collection.deleteMany()` has the following form:

   .. code-block:: javascript

      db.collection.deleteMany( <filter>, { writeConcern: <document> } )

   The method has the following parameters:

   - ``<filter>`` is a document that specifies conditions using
     :ref:`query selectors <query-selectors>`. Specify an empty
     document ``{}`` to delete all documents.

   - Optional. ``writeConcern`` is a document expressing the
     :doc:`write concern </core/write-concern>`. Omit to use the
     default write concern.

   Consider a collection ``sample`` with the following documents:

   .. code-block:: javascript

      { "_id" : 1, "a" : 1, "b" : 1, "status" : "A" }
      { "_id" : 2, "a" : 2, "b" : 2, "status" : "U" }
      { "_id" : 3, "a" : 3, "b" : 3, "status" : "A" }
      { "_id" : 4, "a" : 4, "b" : 4, "status" : "D" }

   The following example deletes all documents with the ``status``
   field equal to ``"A"``.

   .. code-block:: javascript

      db.sample.deleteMany( { status: "A" }, { writeConcern: { w: "majority", wtimeout: 5000 } } )

   The method returns a document with the status of the operation:

   .. code-block:: javascript

      { "acknowledged" : true, "deletedCount" : 2 }

.. _db.collection.deleteOne:

.. method:: db.collection.deleteOne()

   Deletes a single document that match the ``filter`` condition. The
   method deletes a single document even if multiple documents match
   the ``filter``. :method:`db.collection.deleteOne()` is equivalent to
   the :method:`db.collection.remove()` with the ``justOne`` set to
   true.

   :method:`db.collection.deleteOne()` has the following form:

   .. code-block:: javascript

      db.collection.deleteOne( <filter>, { writeConcern: <document> } )

   - ``<filter>`` is a document that specifies conditions using
     :ref:`query selectors <query-selectors>`. Specify an empty
     document ``{}`` to delete all documents.

   - Optional. ``writeConcern`` is a document expressing the
     :doc:`write concern </core/write-concern>`. Omit to use the
     default write concern.

   Consider a collection ``sample`` with the following documents:

   .. code-block:: javascript

      { "_id" : 1, "a" : 1, "b" : 1, "status" : "A" }
      { "_id" : 2, "a" : 2, "b" : 2, "status" : "U" }
      { "_id" : 3, "a" : 3, "b" : 3, "status" : "A" }
      { "_id" : 4, "a" : 4, "b" : 4, "status" : "D" }

   The following example deletes one document with the ``status`` field
   equal to ``"A"``.

   .. code-block:: javascript

      db.sample.deleteOne( { status: "A" }, { writeConcern: { w: "majority", wtimeout: 5000 } } )

   The method returns a document with the status of the operation:

   .. code-block:: javascript

      { "acknowledged" : true, "deletedCount" : 1 }

.. method:: db.collection.findOneAndDelete()

   Removes a single document that matches the ``filter`` condition and
   returns the removed document. The method is equivalent to
   :method:`db.collection.findAndModify()` method with ``remove`` set
   to true.

   :method:`db.collection.findOneAndDelete()` has the following form:

   .. code-block:: javascript

      db.collection.findOneAndDelete( 
         <filter>,
         {
           sort: <document>,
           projection: <document>,
           writeConcern: <document>,
           maxTimeMS: <integer>
         }
      )

   - ``<filter>`` is a document that specifies conditions using
     :ref:`query selectors <query-selectors>`. Specify an empty
     document ``{}`` to match any document.

   - Optional. ``sort`` is a document that sorts the matching documents
     in order to determine which document the operation removes if the
     filter matches multiple documents. The method removes the first
     document in the sort order specified by this argument.

   - Optional. ``projection`` is document that specifies which fields
     to return in the return document.

   - Optional. ``writeConcern`` is a document expressing the
     :doc:`write concern </core/write-concern>`. Omit to use the
     default write concern.

   - Optional. ``maxTimeMS`` is an integer that specifies a cumulative
     time limit in milliseconds for processing operations on a cursor.
     See :method:`cursor.maxTimeMS` for more information.

   Consider a collection ``sample`` with the following documents:

   .. code-block:: javascript

      { "_id" : 1, "a" : 1, "b" : 1, "status" : "A" }
      { "_id" : 2, "a" : 2, "b" : 2, "status" : "U" }
      { "_id" : 3, "a" : 3, "b" : 3, "status" : "A" }
      { "_id" : 4, "a" : 4, "b" : 4, "status" : "D" }

   The following example finds and deletes one document with the
   ``status`` field equal to ``"A"``. The example includes a ``sort``
   document to order the matching documents by descending ``_id``
   values, such that the delete removes the matching document with the
   greatest ``_id`` value:

   .. code-block:: javascript

      db.sample.findOneAndDelete(
         { status: "A" }, 
         { sort: { _id: -1 }, writeConcern: { w: "majority", wtimeout: 5000 } } 
      )

   The method returns the removed document:

   .. code-block:: javascript

      { "_id" : 3, "a" : 3, "b" : 3, "status" : "A" }

   If no document matches the filter condition, the method returns null.

.. method:: db.collection.findOneAndReplace()

   Replaces a single document that matches the ``filter`` condition and
   returns either the pre-replacement version of the document or the
   post-replacement version of the document. The method is equivalent
   to :method:`db.collection.findAndModify()` method with ``update``
   set to a replacement document.

   :method:`db.collection.findOneAndReplace()` has the following form:

   .. code-block:: javascript

      db.collection.findOneAndReplace( 
         <filter>,
         <replacement>
         {
           sort: <document>,
           projection: <document>,
           upsert: <boolean>,
           returnNewDocument: <boolean>
           writeConcern: <document>,
           maxTimeMS: <integer>
         }
      )

   - ``<filter>`` is a document that specifies conditions using
     :ref:`query selectors <query-selectors>`. Specify an empty
     document ``{}`` to match any document.

   - ``<replacement>`` is a document with which to replace the matching
     document. The ``<replacement>`` document cannot specify an ``_id``
     value that differs from the replaced document.

   - Optional. ``sort`` is a document that sorts the matching documents
     in order to determine which document the operation replaces if the
     filter matches multiple documents. The method replaces the first
     document in the sort order specified by this argument.

   - Optional. ``projection`` is document that specifies which fields
     to return in the return document.

   - Optional. ``upsert`` is a boolean that specifies whether the
     operation should create a new document when no document matches
     the ``filter`` conditions. See :term:`upsert` for details.
     The default value is ``false``.

   - Optional. ``returnNewDocument`` is a boolean that determines
     whether the method returns the pre-replacement document or
     post-replacement document. The default value is ``false``.

   - Optional. ``writeConcern`` is a document expressing the
     :doc:`write concern </core/write-concern>`. Omit to use the
     default write concern.

   - Optional. ``maxTimeMS`` is an integer that specifies a cumulative
     time limit in milliseconds for processing operations on a cursor.
     See :method:`cursor.maxTimeMS` for more information.

   Consider a collection ``sample`` with the following documents:

   .. code-block:: javascript

      { "_id" : 1, "a" : 1, "b" : 1, "status" : "A" }
      { "_id" : 2, "a" : 2, "b" : 2, "status" : "U" }
      { "_id" : 3, "a" : 3, "b" : 3, "status" : "A" }
      { "_id" : 4, "a" : 4, "b" : 4, "status" : "D" }

   The following example finds and replaces one document with the
   ``status`` field equal to ``"A"``. The example includes a ``sort``
   document to order the matching documents by descending ``_id``
   values, such that the method replaces the matching document with the
   greatest ``_id`` value:

   .. code-block:: javascript

      db.sample.findOneAndReplace(
         { status: "A" },
         { "a": 5, b: 5, status: "U" },
         { sort: { _id: -1 }, writeConcern: { w: "majority", wtimeout: 5000 } } 
      )

   The method returns the replaced document:

   .. code-block:: javascript

      { "_id" : 3, "a" : 3, "b" : 3, "status" : "A" }

.. method:: db.collection.findOneAndUpdate()

   Updates a single document that matches the ``filter`` condition and
   returns either the pre-update version of the document or the
   post-update version of the document. The method is equivalent to
   :method:`db.collection.findAndModify()` method with ``update`` set
   to a document that specifies modifications using :doc:`update
   operators </reference/operator/update>`.

   :method:`db.collection.findOneAndUpdate()` has the following form:

   .. code-block:: javascript

      db.collection.findOneAndUpdate( 
         <filter>,
         <modifications>
         {
           sort: <document>,
           projection: <document>,
           upsert: <boolean>,
           returnNewDocument: <boolean>
           writeConcern: <document>,
           maxTimeMS: <integer>
         }
      )

   - ``<filter>`` is a document that specifies conditions using
     :ref:`query selectors <query-selectors>`. Specify an empty
     document ``{}`` to match any document.

   - ``<modifications>`` is a document that specifies the modifications
     using the :doc:`update operators </reference/operator/update>`.

   - Optional. ``sort`` is a document that sorts the matching documents
     in order to determine which document the operation updates if the
     filter matches multiple documents. The method updates the first
     document in the sort order specified by this argument.

   - Optional. ``projection`` is document that specifies which fields
     to return in the return document.

   - Optional. ``upsert`` is a boolean that specifies whether the
     operation should create a new document when no document matches
     the ``filter`` conditions. See :term:`upsert` for details.
     The default value is ``false``.

   - Optional. ``returnNewDocument`` is a boolean that determines
     whether the method returns the pre-replacement document or
     post-replacement document. The default value is ``false``.

   - Optional. ``writeConcern`` is a document expressing the
     :doc:`write concern </core/write-concern>`. Omit to use the
     default write concern.

   - Optional. ``maxTimeMS`` is an integer that specifies a cumulative
     time limit in milliseconds for processing operations on a cursor.
     See :method:`cursor.maxTimeMS` for more information.

   Consider a collection ``sample`` with the following documents:

   .. code-block:: javascript

      { "_id" : 1, "a" : 1, "b" : 1, "status" : "A" }
      { "_id" : 2, "a" : 2, "b" : 2, "status" : "U" }
      { "_id" : 3, "a" : 3, "b" : 3, "status" : "A" }
      { "_id" : 4, "a" : 4, "b" : 4, "status" : "D" }

   The following example finds and updates one document with the
   ``status`` field equal to ``"A"``. The example includes a ``sort``
   document to order the matching documents by descending ``_id``
   values, such that the method replaces the matching document with the
   greatest ``_id`` value:

   .. code-block:: javascript

      db.sample.findOneAndUpdate(
         { status: "A" },
         {
           $set: { a: [ 5, 10 ], status: "U" },
           $mul: { b: 10 },
           $currentDate: { lastModified: true }
         },
         {
           sort: { _id: -1 },
           returnNewDocument: true,
           writeConcern: { w: "majority", wtimeout: 5000 }
         }
      )

   The method returns the updated document after the modifications:

   .. code-block:: javascript

      {
        "_id" : 3,
        "a" : [ 5, 10 ],
        "b" : 30,
        "status" : "U",
        "lastModified" : ISODate("2015-08-12T01:08:47.098Z")
      }

.. method:: db.collection.insertMany()

   Inserts multiple documents into the collection. The method is
   equivalent to :method:`db.collection.insert()` method with an array
   of documents as the parameter.

   :method:`db.collection.insertMany()` has the following form:

   .. code-block:: javascript

      db.collection.insertMany( [ <document1>, <document2>,... ], { writeConcern: <document> } )

   - ``<documents>`` are the documents to insert.

   - Optional. ``writeConcern`` is a document expressing the
     :doc:`write concern </core/write-concern>`. Omit to use the
     default write concern.

   The following example inserts three documents into the ``sample`` collection:

   .. code-block:: javascript

      db.sample.insertMany(
         [
            { _id: 10, a: 10, status: "A" },
            { _id: 11, a: 11, status: "A" },
            { _id: 12, a: 12, status: "A" }
         ],
         { writeConcern: { w: "majority", wtimeout: 5000 } }
      )

   The method returns a document with the status of the operation:

   .. code-block:: javascript

      { "acknowledged" : true, "insertedIds" : [ 10, 11, 12 ] }

.. _db.collection.insertOne:

.. method:: db.collection.insertOne()

   Inserts a single document into the collection. The method is
   equivalent to :method:`db.collection.insert()` method with a single
   document as the parameter.

   :method:`db.collection.insertOne()` has the following form:

   .. code-block:: javascript

      db.collection.insertOne( <document>, { writeConcern: <document> } )

   - ``<document>`` is the document to insert.

   - Optional. ``writeConcern`` is a document expressing the
     :doc:`write concern </core/write-concern>`. Omit to use the
     default write concern.

   The following example inserts a document into the ``sample`` collection:

   .. code-block:: javascript

      db.sample.insertOne(
         { _id: 15, a: 15, status: "D" },
         { writeConcern: { w: "majority", wtimeout: 5000 } }
      )

   The method returns a document with the status of the operation:

   .. code-block:: javascript

      { "acknowledged" : true, "insertedId" : 15 }

.. _db.collection.replaceOne:

.. method:: db.collection.replaceOne()

   Replaces a single document that match the ``filter`` condition with
   the specified ``replacement`` document. The method is equivalent to
   :method:`db.collection.update( \<query\>, \<update\> )
   <db.collection.update()>` method with a replacement document as the
   ``<update>`` parameter.

   :method:`db.collection.replaceOne()` has the following form:

   .. code-block:: javascript

     db.collection.replaceOne( <filter>, <replacement>, { upsert: <boolean>, writeConcern: <document> } }

   - ``<filter>`` is a document that specifies conditions using
     :ref:`query selectors <query-selectors>`. Specify an empty
     document ``{}`` to delete all documents.

   - ``<replacement>`` is a document with which to replace the matching
     document. The ``<replacement>`` document cannot specify an ``_id``
     value that differs from the replaced document.

   - Optional. ``upsert`` is a boolean that specifies whether the
     update operation should create a new document when no document
     matches the ``filter`` conditions. See :term:`upsert` for details.
     The default value is ``false``.

   - Optional. ``writeConcern`` is a document expressing the
     :doc:`write concern </core/write-concern>`. Omit to use the
     default write concern.

   Consider a collection ``sample`` with the following documents:

   .. code-block:: javascript

      { "_id" : 1, "a" : 1, "b" : 1, "status" : "A" }
      { "_id" : 2, "a" : 2, "b" : 2, "status" : "U" }
      { "_id" : 3, "a" : 3, "b" : 3, "status" : "A" }
      { "_id" : 4, "a" : 4, "b" : 4, "status" : "D" }

   The following example finds and replaces one document with the
   ``status`` field equal to ``"A"``.

   .. code-block:: javascript

      db.sample.replaceOne(
         { status: "A" },
         { x: 1, y: 1, z: 1 },
         { writeConcern: { w: "majority", wtimeout: 5000 } }
      )

   The method returns a document with the status of the operation:

   .. code-block:: javascript

      { "acknowledged" : true, "matchedCount" : 1, "modifiedCount" : 1 }

.. _db.collection.updateMany:

.. method:: db.collection.updateMany()

   Updates all documents that match the ``filter`` condition. The
   method is equivalent to :method:`db.collection.update( \<query\>,
   \<update\>, { multi: true, ... }) <db.collection.update()>` method
   with an ``<update>`` document that specifies modifications using
   :doc:`update operators </reference/operator/update>` and the
   ``multi`` option set to true.

   :method:`db.collection.updateMany()` has the following form:

   .. code-block:: javascript

      db.collection.updateMany( <filter>, <update>, { upsert: <boolean>, writeConcern: <document> } }

   - ``<filter>`` is a document that specifies conditions using
     :ref:`query selectors <query-selectors>`. Specify an empty
     document ``{}`` to delete all documents.

   - ``<update>`` is a document that specifies the modifications to
     perform using the :doc:`update operators
     </reference/operator/update>`.

   - Optional. ``upsert`` is a boolean that specifies whether the
     update operation should create a new document when no document
     matches the ``filter`` conditions. See :term:`upsert` for details.
     The default value is ``false``.

   - Optional. ``writeConcern`` is a document expressing the
     :doc:`write concern </core/write-concern>`. Omit to use the
     default write concern.

   Consider a collection ``sample`` with the following documents:

   .. code-block:: javascript

      { "_id" : 1, "a" : 1, "b" : 1, "c": 1, "status" : "A" }
      { "_id" : 2, "a" : 2, "b" : 2, "c": 1, "status" : "U" }
      { "_id" : 3, "a" : 3, "b" : 3, "c": 1, "status" : "A" }
      { "_id" : 4, "a" : 4, "b" : 4, "c": 1, "status" : "D" }

   The following example finds and modifies all documents with the
   ``status`` field equal to ``"A"``.

   .. code-block:: javascript

      db.sample.updateMany(
         { status: "A" },
         {
           $set: { a: 5, status: "U" },
           $mul: { b: 10, c: 5 },
           $currentDate: { lastModified: true }
         },
         { writeConcern: { w: "majority", wtimeout: 5000 } }
      )

   The method returns a document with the status of the operation:

   .. code-block:: javascript

      { "acknowledged" : true, "matchedCount" : 2, "modifiedCount" : 2 }

.. _db.collection.updateOne:

.. method:: db.collection.updateOne()

   Updates a single document that match the ``filter`` condition. The
   method updates a single document even if multiple documents match
   the ``filter`` and is equivalent to :method:`db.collection.update(
   <query>, <update> ) <db.collection.update()` method with an
   ``<update>`` document that specifies modifications using
   :doc:`update operators </reference/operator/update>`.

   .. code-block:: javascript

      db.collection.updateOne( <filter>, <update>, { upsert: <boolean>, writeConcern: <document> } }

   - ``<filter>`` is a document that specifies conditions using
     :ref:`query selectors <query-selectors>`. Specify an empty
     document ``{}`` to delete all documents.

   - ``<update>`` is a document that specifies the modifications to
     perform using the :doc:`update operators
     </reference/operator/update>`.

   - Optional. ``upsert`` is a boolean that specifies whether the
     update operation should create a new document when no document
     matches the ``filter`` conditions. See :term:`upsert` for details.
     The default value is ``false``.

   - Optional. ``writeConcern`` is a document expressing the
     :doc:`write concern </core/write-concern>`. Omit to use the
     default write concern.

   Consider a collection ``sample`` with the following documents:

   .. code-block:: javascript

      { "_id" : 1, "a" : 1, "b" : 1, "c": 1, "status" : "A" }
      { "_id" : 2, "a" : 2, "b" : 2, "c": 1, "status" : "U" }
      { "_id" : 3, "a" : 3, "b" : 3, "c": 1, "status" : "A" }
      { "_id" : 4, "a" : 4, "b" : 4, "c": 1, "status" : "D" }

   The following example finds and modifies all documents with the
   ``status`` field equal to ``"A"``.

   .. code-block:: javascript

      db.sample.updateOne(
         { status: "A" },
         {
           $set: { a: 5, status: "U" },
           $mul: { b: 10, c: 5 },
           $currentDate: { lastModified: true }
         },
         { writeConcern: { w: "majority", wtimeout: 5000 } }
      )

   The method returns a document with the status of the operation:

   .. code-block:: javascript

      { "acknowledged" : true, "matchedCount" : 1, "modifiedCount" : 1 }

.. method:: db.collection.bulkWrite()

   Performs bulk writes on a collection. The bulk write operations can
   be either *ordered* or *unordered*. With an ordered list of
   operations, MongoDB executes the operations serially. If an error
   occurs during the processing of one of the write operations, MongoDB
   will return without processing any remaining write operations in the
   list.

   With an unordered list of operations, MongoDB can execute the
   operations in parallel. If an error occurs during the processing of
   one of the write operations, MongoDB will continue to process
   remaining write operations in the list.

   :method:`db.collection.bulkWrite()` has the following form:

   .. code-block:: javascript

      db.collection.bulkWrite(
         [ <operation1>, <operation2>, ... ],
         {
           ordered: <boolean>,
           writeConcern: <document>
         }
      )

   .. TODO remove internal hyperlink targets and use :method: when moving into separate pages

   The method accepts an array of ``<operations>`` to perform in bulk.
   The ``<operations>`` correspond to db.collection.insertOne_,
   db.collection.updateOne_, db.collection.updateMany_,
   db.collection.replaceOne_, db.collection.deleteOne_, and
   db.collection.deleteMany_ methods, and the array can include these
   operations in any combination.

   The method also accepts an optional document to specify whether to
   execute the list in *ordered* (the default) or in *unordered*
   sequence as well as the :doc:`write concern </core/write-concern>`.

   Specify the ``<operations>`` in the following form:

   .. list-table::

      * - .. code-block:: json

             { insertOne: { document: <document> } }

      * - .. code-block:: json

             { updateOne: { filter: <document>, update: <document>, upsert: <boolean> } }

      * - .. code-block:: json

             { updateMany: { filter: <document>, update: <document>, upsert: <boolean> } }

      * - .. code-block:: json

             { replaceOne: { filter: <document>, replacement: <document>, upsert: <boolean> } }

      * - .. code-block:: json

             { deleteOne: { filter: <document> } }

      * - .. code-block:: json

             { deleteMany: { filter: <document> } }

   The following example uses :method:`db.collection.bulkWrite()`
   method to insert four documents into the ``sample`` collection,
   update all documents that matches the specified filter. The example
   specifies that MongoDB executes the operations in an ordered
   sequence, uses a write concern of ``"majority"`` and a
   :ref:`wc-wtimeout` of ``5000`` milliseconds.

   .. code-block:: javascript

      db.sample.bulkWrite(
         [
            { insertOne: { document: { _id: 1, a: 1, b: 1, status: "A" } } },
            { insertOne: { document: { _id: 2, a: 2, b: 2, status: "N" } } },
            { insertOne: { document: { _id: 3, a: 3, b: 3, status: "A" } } },
            { insertOne: { document: { _id: 4, a: 4, b: 4, status: "D" } } },
            { updateMany: { filter: { status: "N" }, update: { $set: { status: "U" } } } },
            { ordered: true, writeConcern: { w: "majority", wtimeout: 5000 } }
         ]
      )

   The method returns the status of the operations:

   .. code-block:: javascript

      {
         "acknowledged" : true,
         "deletedCount" : 0,
         "insertedCount" : 4,
         "matchedCount" : 1,
         "upsertedCount" : 0,
         "insertedIds" : {
            "0" : 1,
            "1" : 2,
            "2" : 3,
            "3" : 4
         },
         "upsertedIds" : {

         }
      }

   :method:`db.collection.bulkWrite()` is equivalent to initializing
   :method:`Bulk()` operations builder, using :ref:`Bulk methods
   <bulk-methods>` to add operations, and running
   :method:`Bulk.execute()` to execute the operations.
   
Bit Test Query Operators
------------------------

MongoDB 3.2 introduces the four new bit test query operators.
The bit test query operators allow applications to test whether
particular bits are set or clear in bitpacked numerical fields or in
fields storing binary data.

Behavior
~~~~~~~~

#. The operators can only test fields whose values are either number or
   BinData. Values of other types will not match.

#. If the value is a BSONType double, the value must be an integer,
   i.e. cannot have a fractional part, and must be representable as a
   64-bit signed integer, i.e. cannot be too big (2\ :sup:`100`) or too
   small (-2\ :sup:`100`).

   If the double value meets the criteria, the operators convert the
   double to a 64-bit signed integer before applying the bit test.

#. Numbers are sign extended in order to handle bit positions beyond
   the 64 bits of a long. For example, we consider bit position ``200``
   set for the number ``-5`` but we consider bit position ``200`` clear
   for the number ``+5``.

.. _3.2-ref-case-sensitive-text-search:

Case Sensitive Text Search Examples
-----------------------------------

.. TODO remove in 3.2

.. versionchanged:: 3.2

   With the introduction of the ``text`` index version 3, MongoDB
   expands the :ref:`case insensitivity
   <3.2-relnotes-text-index-case-insensitivity>` of the ``text``` index to
   include Latin characters with :ref:`diacritics
   <3.2-text-index-v3-diacritic-sensitivity>` and characters from some
   non-Latin alphabets, such as the Cyrillic alphabet.

   Earlier versions of the ``text`` index are case insensitive for
   Latin characters without diacritic marks.

The :query:`$text` operator adds support for case sensitive text search
with the new ``$caseSensitive`` option.

For more information on case sensitive text search, see
:ref:`3.2-case-sensitive-text-search`.

Case Sensitive Search for a Phrase
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

If the ``articles`` collection contains the following documents:

.. code-block:: json

   { "_id" : 4, "subject" : "café con leche" }
   { "_id" : 5, "subject" : "Café Con Leche" }
   { "_id" : 6, "subject" : "Café con leche" }

The following query performs a case sensitive search for the phrase
``Café Con Leche``:

.. code-block:: javascript

   db.articles.find( { 
      $text: { $search: "\"Café Con Leche\"", $language: "es", $caseSensitive: true }
   } )

The search matches just the document:

.. code-block:: json

   { "_id" : 5, "subject" : "Café Con Leche" }

.. note::

   For ``$caseSensitive: true``, the :query:`$text` operator performs
   an exact match on the phrase when filtering out documents.

Case Sensitivity with Negated Term
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

A *negated* term is a term that is prefixed by a minus sign ``-``. If
you negate a term, the :query:`$text` operator will exclude the
documents that contain those terms from the results. You can also
specify case sensitivity for negated terms.

The following example performs a case sensitive search for documents
that contain the words ``bake`` or ``coffee`` but do **not** contain
the term ``milk``:

.. code-block:: javascript

   db.articles.find( { $text: { $search: "bake coffee -milk", $caseSensitive: true } } )

The query matches the following document:

.. code-block:: json

   { "_id" : 3, "subject" : "coffee and Milk" }

View Document Validation Information
------------------------------------

To view the validation specifications for a collection, you can use the
:method:`db.getCollectionInfos( )` method and the
:dbcommand:`listCollections` command.

If a collection includes :ref:`3.2-rel-notes-document-validation`
settings, the :dbcommand:`listCollections` command and the
:method:`db.getCollectionInfos()` method will include them in the
output for the collections.

``find`` and ``getMore`` Commands
---------------------------------

:dbcommand:`find` and :dbcommand:`getMore` commands require an upgrade
of the official MongoDB drivers.

.. versionadded:: 3.2

.. dbcommand:: find

   Executes a query and returns the first batch of results and the
   cursor id, from which the client can construct a cursor.

   The :dbcommand:`find` command has the following form:

   .. code-block:: javascript

      {
         "find": <string>,
         "filter": <document>,
         "sort": <document>,
         "projection": <document>,
         "hint": <document or string>,
         "skip": <int>,
         "limit": <int>,
         "batchSize": <int>,
         "singleBatch": <bool>,
         "comment": <string>,
         "maxScan": <int>,
         "maxTimeMS": <int>,
         "readConcern": <document>,
         "max": <document>,,
         "min": <document>,,
         "returnKey": <bool>,
         "showRecordId": <bool>,
         "snapshot": <bool>,
         "tailable": <bool>,
         "oplogReplay": <bool>,
         "noCursorTimeout": <bool>,
         "awaitData": <bool>,
         "allowPartialResults": <bool>
      }

   The command accepts the following fields:

   .. list-table::
      :header-rows: 1
      :widths: 20 15 65

      * - Field
        - Type
        - Description

      * - ``find``
        - String
        - The name of the collection to query.

      * - ``filter``

        - Document

        - Optional. The query predicate. If unspecified, then all
          documents in the collection will match the predicate.

      * - ``sort``

        - Document

        - Optional. The sort specification for the ordering of the results.
  
      * - ``projection``

        - Document

        - Optional. The :ref:`projection specification <projections>`
          to determine which fields to include in the returned
          documents. See :ref:`projections` and
          :doc:`/reference/operator/projection`.

      * - ``hint``

        - String or document

        - Optional. Index specification. Specify either the index name as a
          string or the index key pattern. If specified, then
          the query system will only consider plans using the hinted index.

      * - ``skip``

        - Positive integer

        - Optional. Number of documents to skip. Defaults to 0.

      * - ``limit``

        - Non-negative integer

        - Optional. The maximum number of documents to return. If
          unspecified, then defaults to no limit. A limit of 0 is
          equivalent to setting no limit.

      * - ``batchSize``

        - Non-negative integer
  
        - Optional. The number of documents to return in the first batch.
          Defaults to 101. A ``batchSize`` of 0 means that the cursor will be
          established, but no documents will be returned in the first batch.

.. For the reference page, add the sentence:
   Unlike the previous wire protocol version, a ``batchSize`` of 1 for
   the :dbcommand:`find` command does not close the cursor.

      * - ``singleBatch``

        -  Boolean

        - Optional. Determines whether to close the cursor after the first
          batch. Defaults to false.

      * - ``comment``

        - String

        - A comment to attach to the query to help interpret and trace query
          :dbcommand:`profile` data.

      * - ``maxScan``

        - Positive integer

        - Optional. Maximum number of documents or index keys to scan
          when executing the query.

      * - ``maxTimeMS``

        - Positive integer

        - Optional. The cumulative time limit in milliseconds for processing
          operations on the cursor. MongoDB aborts the operation at the
          earliest following :term:`interrupt point`.

      * - ``readConcern``

        - Document

        - Optional. The :ref:`3.2-rel-notes-readConcern` specification.

      * - ``max``

        - Document

        - Optional. The *exclusive* upper bound for a specific
          index. See :method:`cursor.max()` for details.

      * - ``min``

        - Document

        - Optional. The *inclusive* lower bound for a specific
          index. See :method:`cursor.min()` for details.

      * - ``returnKey``

        - Boolean

        - Optional. If true, returns only the index keys in the
          resulting documents. Default value is false. If ``returnKey``
          is ``true`` and the :dbcommand:`find` command does not use an
          index, the returned documents will be empty.

      * - ``showRecordId``

        - Boolean

        - Optional. Determines whether to return the record identifier
          for each document. If true, adds a field ``$recordId`` to the
          returned documents.

      * - ``snapshot``

        - Boolean

        - Optional. Prevents the cursor from returning a document more than
          once because of an intervening write operation.

      * - ``tailable``

        - Boolean

        - Optional. Returns a :term:`tailable cursor` for a capped collections.

      * - ``awaitData``
      
        - Boolean

        - Optional. Use in conjunction with the ``tailable`` option to
          block a :dbcommand:`getMore` command on the cursor
          temporarily if at the end of data rather than returning no
          data. After a timeout period, :dbcommand:`find` returns as
          normal.

      * - ``oplogReplay``

        - Boolean

        - Optional. Internal use for replica sets. To use
          ``oplogReplay``, you must include the following condition in
          the ``filter``:

          .. code-block:: javascript

             { ts: { $gte: <timestamp> } }

      * - ``noCursorTimeout``

        - Boolean

        - Optional. Prevents the server from timing out idle cursors after an
          inactivity period (10 minutes).

      * - ``allowPartialResults``

        - Boolean

        - Optional. For queries against a sharded collection, returns partial
          results from the :program:`mongos` if some shards are unavailable
          instead of throwing an error.

   For example, the following command runs the :dbcommand:`find`
   command filtering on the ``rating`` field and the ``cuisine`` field.
   The command includes a ``projection`` to only return the
   following fields in the matching documents: ``_id``, ``name``,
   ``rating``, and ``address`` fields.

   The command sorts the documents in the result set by the ``name``
   field and limits the result set to 5 documents.

   .. code-block:: javascript

      db.runCommand(
         {
           find: "restaurants",
           filter: { rating: { $gte: 9 }, cuisine: "italian" },
           projection: { name: 1, rating: 1, address: 1 },
           sort: { name: 1 },
           limit: 5
         }
      )

.. versionadded:: 3.2

.. dbcommand:: getMore

   Use in conjunction with commands that return a cursor, e.g.
   :dbcommand:`find` and :dbcommand:`aggregate`, to return subsequent
   batches of documents currently pointed to by the cursor.

   The :dbcommand:`getMore` command has the following form:

   .. code-block:: javascript

      {
         "getMore": <long>,
         "collection": <string>,
         "batchSize": <int>,
         "maxTimeMS": <int>
      }

   The command accepts the following fields:

   .. list-table::
      :header-rows: 1
      :widths: 20 15 65

      * - Field
        - Type
        - Description

      * - ``getMore``

        - Long

        - The cursor id.

      * - ``collection``

        - String

        - The name of the collection over which the cursor is
          operating.

      * - ``batchSize``

        - Non-negative integer.

        - Optional. The number of documents to return in the batch.

      * - ``maxTimeMS``

        - Positive integer.

        - Optional. The timeout duration in milliseconds.

Diagnostic Parameters
---------------------

To support the diagnostic feature, MongoDB introduces the following
parameters:

.. |mongod-only| replace:: Available for :program:`mongod` only.

.. parameter:: diagnosticDataCollectionEnabled

   .. versionadded:: 3.2

   *Type*: boolean

   *Default*: true

   |mongod-only|

   Determines whether to enable the collecting and logging of data for
   diagnostic purposes. Diagnostic logging is enabled by default.

   For example, the following disables the diagnostic collection:

   .. code-block:: sh

      mongod --setParameter diagnosticDataCollectionEnabled=false

.. parameter:: diagnosticDataCollectionDirectorySizeMB

   .. versionadded:: 3.2

   *Type*: integer

   *Default*: 100

   |mongod-only|

   Specifies the maximum size, in megabytes, of the ``diagnostic.data``
   directory . If directory size exceeds this number, the oldest
   :ref:`diagnostic files in the directory
   <3.2-diagnostic-data-capture>` are automatically deleted based on
   the timestamp in the file name.

   For example, the following sets the maximum size of the directory to
   ``200`` megabytes:

   .. code-block:: sh

      mongod --setParameter diagnosticDataCollectionDirectorySizeMB=200

   The minimum value for
   :parameter:`diagnosticDataCollectionDirectorySizeMB` is ``10``
   megabytes. :parameter:`diagnosticDataCollectionDirectorySizeMB` must
   be greater than maximum diagnostic file size
   :parameter:`diagnosticDataCollectionFileSizeMB`.

.. parameter:: diagnosticDataCollectionFileSizeMB

   .. versionadded:: 3.2

   *Type*: integer

   *Default*: 10

   |mongod-only|

   Specifies the maximum size, in megabytes, of each :ref:`diagnostic
   file <3.2-diagnostic-data-capture>`. If the file exceeds the maximum
   file size, MongoDB creates a new file.

   For example, the following sets the maximum size of each diagnostic
   file to ``20`` megabytes:

   .. code-block:: sh

      mongod --setParameter diagnosticDataCollectionFileSizeMB=20

   The minimum value for
   :parameter:`diagnosticDataCollectionFileSizeMB` is ``1`` megabyte.

.. parameter:: diagnosticDataCollectionPeriodMillis

   .. versionadded:: 3.2

   *Type*: integer

   *Default*: 1000

   |mongod-only|

   Specifies the interval, in milliseconds, at which to collect
   diagnostic data.

   For example, the following sets the interval to
   ``5000`` milliseconds or 5 seconds:

   .. code-block:: sh

      mongod --setParameter diagnosticDataCollectionPeriodMillis=5000

   The minimum value for
   :parameter:`diagnosticDataCollectionPeriodMillis` is ``100``
   milliseconds.

.. _3.2-replica-set-options:

Replica Sets
------------

Replica Set Config Servers Setting
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To support :ref:`replica set config servers
<3.2-rel-notes-sharded-cluster>`, MongoDB introduces the following new
configuration setting:

.. rsconf:: configsvr

   .. versionadded:: 3.2

   *Type*: boolean

   *Default*: false

   Indicates whether the replica set is used for a sharded cluster's
   config servers. Set to ``true`` if the replica set is for a sharded
   cluster's config servers.

Replica Set Election Setting
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To support the enhanced replica set election and failover algorithm,
MongoDB introduces the following new replica set configuration settings:

.. rsconf:: protocolVersion

   .. versionadded:: 3.2

   *Type*: int

   *Default*: 1

   The version number of the replication protocol.

   To enable :ref:`replication election enhancements
   <3.2-rel-notes-rs-enhancements>` introduced in MongoDB 3.2, the
   replica set must be configured to :rsconf:`protocolVersion: 1
   <protocolVersion>`. By default, new replica sets in 3.2 use
   :rsconf:`protocolVersion: 1 <protocolVersion>`.

   Prior to MongoDB 3.2, replica sets used protocol version 0.

.. rsconf:: settings.electionTimeoutMillis

   .. versionadded:: 3.2

   *Type*: int

   *Default*: 10000 (i.e. 10 seconds)

   The time limit in milliseconds for detecting when a replica set's
   primary is unreachable:

   - Higher values result in slower failovers but decreased sensitivity to
     primary node or network slowness or spottiness.

   - Lower values result in faster failover but increased sensitivity to
     primary node or network slowness or spottiness.

   :rsconf:`settings.electionTimeoutMillis` is only
   applicable when :rsconf:`protocolVersion` is 1.

.. rsconf:: settings.heartbeatIntervalMillis

   .. versionadded:: 3.2

   *Type*: int

   *Default*: 2000

   Frequency in milliseconds of the heartbeats. *Internal use only.*

``mongod`` Parameter
~~~~~~~~~~~~~~~~~~~~

.. parameter:: replWriterThreadCount

   .. versionadded:: 3.2

   *Type*: int

   *Default*: 16

   |mongod-only|

   Number of threads to use to apply replicated operations in parallel.
   Values can range from 1 to 256 inclusive.

   You can only set :parameter:`replWriterThreadCount` during startup
   and cannot change this setting using the :dbcommand:`setParameter`
   database command.

.. _3.2-encryption-key-management-options:

Key Management Configuration Options
------------------------------------

MongoDB Enterprise 3.2 adds the following configuration
options to support encryption for the WiredTiger storage engine.

Command Line Options
~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/fact-enterprise-only-admonition.rst

.. option:: enableEncryption

   *Type*: boolean

   *Default*: false

   Enables encryption for the WiredTiger storage engine. You must set
   to ``true`` to pass in encryption keys and configurations.

.. option:: encryptionCipherMode

   The cipher mode to use for encryption at rest:

   .. list-table::
      :header-rows: 1
      :widths: 35 65

      * - Mode
        - Description

      * - ``AES256-CBC``
        - 256-bit Advanced Encryption Standard in Cipher Block Chaining
          Mode

      * - ``AES256-GCM``

        - 256-bit Advanced Encryption Standard in Galois/Counter Mode

.. option:: encryptionKeyFile

   *Type*: string

   The path to the local keyfile when managing keys via process *other
   than* KMIP. Only set when managing keys via process other than KMIP.
   If data is already encrypted using KMIP, MongoDB will throw an error.

   Requires :setting:`enableEncryption` to be ``true``.

.. option:: kmipKeyIdentifier

   *Type*: string

   Unique KMIP identifier for an existing key within the KMIP server.
   Include to use the key associated with the identifier as the system
   key. You can only use the setting the first time you enable
   encryption for the :program:`mongod` instance. Requires
   :setting:`enableEncryption` to be true.
   
   If unspecified, MongoDB will request that the KMIP server create a
   new key to utilize as the system key.

   If the KMIP server cannot locate a key with the specified identifier
   or the data is already encrypted with a key, MongoDB will throw an
   error

.. option:: kmipRotateMasterKey

   .. versionadded:: 3.2

   *Type*: boolean

   *Default*: false

   If true, rotate the master key and re-encrypt the internal
   keystore.

   .. seealso:: :ref:`3.1-kmip-master-key-rotation`

.. option:: kmipServerName

   *Type*: string

   Hostname or IP address of key management solution running a KMIP
   server. Requires :setting:`enableEncryption` to be true.

.. option:: kmipPort

   *Type*: string

   *Default*: 5696

   Port number the KMIP server is listening on. Requires that a
   :setting:`kmipServerName` be provided. Requires
   :setting:`enableEncryption` to be true.

.. option:: kmipClientCertificateFile

   *Type*: string

   String containing the path to the client certificate used for
   authenticating MongoDB to the KMIP server. Requires that a
   :setting:`kmipServerName` be provided.

.. option:: kmipClientCertificatePassword

   *Type*: string

   The password (if one exists) for the client certificate passed into
   :setting:`kmipClientCertificateFile`. Is used for
   authenticating MongoDB to the KMIP server. Requires that a
   :setting:`kmipClientCertificateFile` be provided.

.. option:: kmipServerCAFile

   *Type*: string

   Path to CA File. Used for validating secure client connection to
   KMIP server.

Configuration File Options
~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/fact-enterprise-only-admonition.rst

.. code-block:: yaml

   security:
      enableEncryption: <boolean>
      encryptionCipherMode: <string>
      encryptionKeyFile: <string>
      kmip:
         keyIdentifier: <string>
         rotateMasterKey: <boolean>
         serverName: <string>
         port: <string>
         clientCertificateFile: <string>
         clientCertificatePassword: <string>
         serverCAFile: <string>


.. setting:: security.enableEncryption

   *Type*: boolean

   *Default*: false
   
   Enables encryption for the WiredTiger storage engine. You must set
   to ``true`` to pass in encryption keys and configurations.

.. setting:: encryptionCipherMode

   *Type*: string

   *Default*: ``AES256-CBC``

   .. versionadded:: 3.2

   The cipher mode to use for encryption at rest:

   .. list-table::
      :header-rows: 1
      :widths: 35 65

      * - Mode
        - Description

      * - ``AES256-CBC``
        - 256-bit Advanced Encryption Standard in Cipher Block Chaining
          Mode

      * - ``AES256-GCM``

        - 256-bit Advanced Encryption Standard in Galois/Counter Mode

.. setting:: security.encryptionKeyFile

   *Type*: string

   The path to the local keyfile when managing keys via process *other
   than* KMIP. Only set when managing keys via process other than KMIP.
   If data is already encrypted using KMIP, MongoDB will throw an error.

   Requires :setting:`security.enableEncryption` to be ``true``.

.. setting:: security.kmip.keyIdentifier

   *Type*: string

   Unique KMIP identifier for an existing key within the KMIP server.
   Include to use the key associated with the identifier as the system
   key. You can only use the setting the first time you enable
   encryption for the :program:`mongod` instance. Requires
   :setting:`security.enableEncryption` to be true.
   
   If unspecified, MongoDB will request that the KMIP server create a
   new key to utilize as the system key.

   If the KMIP server cannot locate a key with the specified identifier
   or the data is already encrypted with a key, MongoDB will throw an
   error.

.. setting:: security.kmip.rotateMasterKey

   *Type*: boolean

   *Default*: false

   If true, rotate the master key and re-encrypt the internal
   keystore.

   .. seealso:: :ref:`3.1-kmip-master-key-rotation`

.. setting:: security.kmip.serverName

   *Type*: string

   Hostname or IP address of key management solution running a KMIP
   server. Requires :setting:`security.enableEncryption` to be true.

.. setting:: security.kmip.port

   *Type*: string

   *Default*: 5696

   Port number the KMIP server is listening on. Requires that a
   :setting:`security.kmip.serverName` be provided. Requires
   :setting:`security.enableEncryption` to be true.

.. setting:: security.kmip.clientCertificateFile

   *Type*: string

   String containing the path to the client certificate used for
   authenticating MongoDB to the KMIP server. Requires that a
   :setting:`security.kmip.serverName` be provided.

.. setting:: security.kmip.clientCertificatePassword

   *Type*: string

   The password to decrypt the client certificate (i.e.
   :setting:`security.kmip.clientCertificateFile`), used to
   authenticate MongoDB to the KMIP server. Use the option only if the
   certificate is encrypted.

.. setting:: security.kmip.serverCAFile

   *Type*: string

   Path to CA File. Used for validating secure client connection to
   KMIP server.

See also :doc:`/release-notes/3.2`.
