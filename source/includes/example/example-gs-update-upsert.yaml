collection: "inventory"
options:
  show_title: False
  show_collection: False
content:
  source:
    file: example/example-gs-insert.yaml
    ref: 0
---
title:
  text: "Specify ``upsert: true`` for replacement operation."
  level: 3
ref: 1
operation:
  pre: |
    The following operation either updates a matching
    document by replacing it with a new document or inserts a new
    document if no matching document exists.
  language: javascript
  code: |
     db.inventory.update( 
         { item: "TBD1" },
         {
           item: "TBD1",
           details: { "model" : "14Q4", "manufacturer" : "ABC Company" },
           stock: [ { "size" : "S", "qty" : 25 } ], 
           category: "houseware"
         },
         { upsert: true }
     )
post: |
   The update operation returns a :method:`WriteResult` object which
   contains the status of the operation.
results: |
  WriteResult({
      "nMatched" : 0,
      "nUpserted" : 1,
      "nModified" : 0,
      "_id" : ObjectId("53dbd684babeaec6342ed6c7")
  })
final: |
  The :data:`~WriteResult.nMatched` field shows that the operation
  matched ``0`` documents.

  The :data:`~WriteResult.nUpserted` of ``1`` shows that the operation
  added a document through an ``upsert``.

  The :data:`~WriteResult.nModified` of ``0`` specifies that no
  existing documents were updated.

  The ``_id`` field shows the generated ``_id`` field for the new
  document.
---
title:
  text: "Specify ``upsert: true`` to update specific fields operation."
  level: 3
ref: 2
operation:
  pre: |
      The following update operation either updates specific
      fields of a matching document or adds a new document if no
      matching document exists.
  language: javascript
  code: |
    db.inventory.update( 
       { item: "TBD2" },
       {
         $set: {
            details: { "model" : "14Q3", "manufacturer" : "IJK Co." },
            category: "houseware"
         }
       },
       { upsert: true }
    )
post: |
  The update operation returns a :method:`WriteResult` object which
  contains the status of the operation.
results: |
       WriteResult({
           "nMatched" : 0,
           "nUpserted" : 1,
           "nModified" : 0,
           "_id" : ObjectId("53dbd7c8babeaec6342ed6c8")
       })
final: |
  The :data:`~WriteResult.nMatched` field shows that the operation
  matched ``0`` documents.

  The :data:`~WriteResult.nUpserted` of ``1`` shows that the operation
  added a document through an ``upsert``.

  The :data:`~WriteResult.nModified` of ``0`` specifies that no
  existing documents were updated.

  The ``_id`` field shows the generated ``_id`` field for the new
  document.
...