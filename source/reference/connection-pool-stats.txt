====================================
Connection Pool Statistics Reference
====================================

.. default-domain:: mongodb

Synopsis
--------

:program:`mongos` instances maintain a pool of connections for
interacting with the constituent members of the :term:`shard clusters
<shard cluster>`. The :dbcommand:`connPoolStats` returns statistics
regarding these connection pools.

.. include:: /includes/note-conn-pool-stats

Output
------

.. stats:: hosts

   :stats:`hosts` contains a document for every member in the
   connection pool, every :term:`shard cluster`, :term:`replica
   set`, and :term:`config database`.

.. stats:: hosts.[host].available
   
   The cummulative number of connections in the connection pool
   available for a host to connect to a :program:`mongos`.

.. stats:: hosts.[host].created

   The number of connections in the connection pool that has ever
   been created for this host by the :program:`mongos`.

.. stats:: replicaSets

   This field holds a document that contains detailed replica set
   information.

  .. stats:: replicaSets.shard

     This document gives details on each shard within the replica set.

    .. stats:: replicaSets.[shard].host

       This :term:`document` gives details on each host within the shard in the replica set.

       These values derive from the :doc:`replica set status
       </reference/replica-status>` values.

      .. stats:: replicaSets.[shard].[host].addr

         This field indicates the address for a particular host in
         the :term:`shard cluster` in the format of
         "``[hostname]:[port]``".

      .. stats:: replicaSets.[shard].[host].ok

         This field indicates whether the host is accessible for
         queries.

         .. TODO verify with someone more knowledgable.

      .. stats:: replicaSets.[shard].[host].ismaster

         A field indicates whether this host is the :term:`master`
         member of the replica set.

      .. stats:: replicaSets.[shard].[host].hidden

         This field indicates whether this host is a :term:`hidden
         member` of the replica set.

      .. stats:: replicaSets.[shard].[host].secondary

         This field indicates whether this host is a
         :term:`secondary` member of the replica set.

      .. stats:: replicaSets.[shard].[host].pingTimeMillis

         This field indicates the ping time in miliseconds from the
         :program:`mongos`

   .. stats:: replicaSets.[shard].master

      This field indicates the number of the host that is the
      :term:`master` from the ``hosts`` list.

   .. stats:: replicaSets.[shard].nextSlave

      This field indicates the number of the host that is the next
      :term:`secondary` to read from instead of :term:`master` from
      the ``hosts`` list.

      .. TODO verify with someone more knowledgable.

.. stats:: createdByType

   The number of each type of connection that :program:`mongos` has
   created in all connection pools.

   .. stats:: createdByType.master

      The total number of connections created to connect to a
      :term:`shard cluster` that is a :term:`master` member.

   .. stats:: createdByType.set

      The total number of connections created to connect to a :term:`replica
      set` member.

   .. stats:: createdByType.sync

      The total number of connections created to connect to the
      :term:`config database`.

.. stats:: totalAvailable

   A running total of connections available in all connection pools.

.. stats:: totalCreated

   The total number of connections ever created in all connection pools.

.. stats:: numDBClientConnection

   The number of normal client connections in the connection pool.

   .. TODO verify - unlike scoped, does this stay connected when
   .. there is an exception?

.. stats:: numAScopedConnection

   The number of exception safe connections that exists in the
   connection pool. The :program:`mongos will release all connections
   when there is an exception thrown in MongoDB.
